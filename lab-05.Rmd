---
title: "Lab 05 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Saima Arina"
date: "02/15/2026"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

### Exercise 1

```{r - filter dennys for Alaska}
dn_ak <- dennys %>%
  filter(state == "AK")
nrow(dn_ak)
```

There are 3 Denny's locations in Alaska.

```{r - filter la quintas for Alaska}
lq_ak <- laquinta %>%
  filter(state == "AK")
nrow(lq_ak)
```

There are 3 La Quinta locations in Alaska.

### Exercise 2

```{r - how many pairings between all dennys and la quinta locations in AK}
nrow(dn_ak) * nrow(lq_ak)
```

There are 6 pairings we need to calculate.

### Exercise 3

```{r - join dataframes}
dn_lq_ak <- full_join(dn_ak, lq_ak,
  by = "state"
)
dn_lq_ak
```

### Exercise 4

```{r - observations and variables}
nrow(dn_lq_ak)
ncol(dn_lq_ak)
```

There are 6 observations in the joined data frame. The names of the variables in this data frame is: address, city, state, zip, longitude, and latitude. 


### Exercise 5

We use the function "mutate" from the tidyverse to add a new variable to a data frame while keeping the existing variables. 

```{r}
haversine <- function(long1, lat1, long2, lat2, round = 3) {
  # convert to radians
  long1 <- long1 * pi / 180
  lat1 <- lat1 * pi / 180
  long2 <- long2 * pi / 180
  lat2 <- lat2 * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
}
```


### Exercise 6

```{r - calculate distance between all pairings}
dn_lq_ak <- dn_lq_ak %>% 
  mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y, round = 3))
```

### Exercise 7

```{r - calculate minimum distances between locations}
dn_lq_ak <- dn_lq_ak %>% 
  group_by(address.x) %>% 
  mutate(min_distance = min(distance)) 
```

### Exercise 8

```{r - putting min distance in new dataframe to visualize}
dn_min_ak <- dn_lq_ak %>%
  group_by(address.x) %>%       
  summarize(min_distance = min(distance))
```

```{r - distribution of distances in AK}
ggplot(dn_min_ak, aes (x = min_distance)) +
  geom_histogram(binwidth = 2) +
  labs(
    x = "Distance(minimum) to nearest La Quinta Location (km)",
    y = "Number of Denny's Locations",
    title = "Distance to Nearest La Quinta Location for Denny's in Alaska"
  )
```

```{r - summary stats}
dn_min_ak %>%
  summarize(
    n      = n(),
    mean   = mean(min_distance),
    sd     = sd(min_distance),
    median = median(min_distance),
    min    = min(min_distance),
    max    = max(min_distance)
  )

```

The distribution of distances from Denny’s to the nearest La Quinta in Alaska is skewed to the left, with one Denny’s about 2 km away and the others about 6 km away.


### Exercise 9

```{r - analyzing NC}
dn_nc <- dennys %>%      
  filter(state == "NC")
 lq_nc <- laquinta %>%
   filter(state == "NC")
 
dn_lq_nc <- full_join(dn_nc, lq_nc,
                      by = "state"
)

dn_lq_nc <- dn_lq_nc %>% 
  mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y, round = 3))


dn_lq_nc <- dn_lq_nc %>% 
  group_by(address.x) %>% 
  mutate(min_distance = min(distance)) 

dn_min_nc <- dn_lq_nc %>%
  group_by(address.x) %>%       
  summarize(min_distance = min(distance))

ggplot(dn_min_nc, aes (x = min_distance)) +
  geom_histogram(binwidth = 10) +
  labs(
    x = "Distance(minimum) to nearest La Quinta Location (km)",
    y = "Number of Denny's Locations",
    title = "Distance to Nearest La Quinta Location for Denny's in North Carolina"
  )
```

```{r - summary stats of NC}
dn_min_nc %>%
  summarize(
    n      = n(),
    mean   = mean(min_distance),
    sd     = sd(min_distance),
    median = median(min_distance),
    min    = min(min_distance),
    max    = max(min_distance)
  )
```

The distribution of distances from Denny’s to the nearest La Quinta in North Carolina is skewed to the right, with most Denny’s within 80 km away and a few others about much farther away, over 150 km.

### Exercise 10

```{r - analyzing TX}
dn_tx <- dennys %>%      
  filter(state == "TX")
 lq_tx <- laquinta %>%
   filter(state == "TX")
 
dn_lq_tx <- full_join(dn_tx, lq_tx,
                      by = "state"
)

dn_lq_tx <- dn_lq_tx %>% 
  mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y, round = 3))


dn_lq_tx <- dn_lq_tx %>% 
  group_by(address.x) %>% 
  mutate(min_distance = min(distance)) 

dn_min_tx <- dn_lq_tx %>%
  group_by(address.x) %>%       
  summarize(min_distance = min(distance))

ggplot(dn_min_tx, aes (x = min_distance)) +
  geom_histogram(binwidth = 4) +
  labs(
    x = "Distance(minimum) to nearest La Quinta Location (km)",
    y = "Number of Denny's Locations",
    title = "Distance to Nearest La Quinta Location for Denny's in Texas"
  )
```

```{r - summary stats of TX}
dn_min_tx %>%
  summarize(
    n      = n(),
    mean   = mean(min_distance),
    sd     = sd(min_distance),
    median = median(min_distance),
    min    = min(min_distance),
    max    = max(min_distance)
  )
```

The distribution of distances from Denny’s to the nearest La Quinta in Texas is skewed to the right, with most Denny’s within 10 km and only a few others that are over 20 km away.


### Exercise 11

```{r - analyzing NY}
dn_ny <- dennys %>%      
  filter(state == "NY")
 lq_ny <- laquinta %>%
   filter(state == "NY")
 
dn_lq_ny <- full_join(dn_ny, lq_ny,
                      by = "state"
)

dn_lq_ny <- dn_lq_ny %>% 
  mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y, round = 3))


dn_lq_ny <- dn_lq_ny %>% 
  group_by(address.x) %>% 
  mutate(min_distance = min(distance)) 

dn_min_ny <- dn_lq_ny %>%
  group_by(address.x) %>%       
  summarize(min_distance = min(distance))

ggplot(dn_min_ny, aes (x = min_distance)) +
  geom_histogram(binwidth = 10) +
  labs(
    x = "Distance(minimum) to nearest La Quinta Location (km)",
    y = "Number of Denny's Locations",
    title = "Distance to Nearest La Quinta Location for Denny's in New York"
  )
```

```{r - summary stats of NY}
dn_min_ny %>%
  summarize(
    n      = n(),
    mean   = mean(min_distance),
    sd     = sd(min_distance),
    median = median(min_distance),
    min    = min(min_distance),
    max    = max(min_distance)
  )
```


The distribution of distances from Denny’s to the nearest La Quinta in New York is skewed to the right, with most Denny’s within 30 km and others that are over 50 km away.


### Exercise 12



